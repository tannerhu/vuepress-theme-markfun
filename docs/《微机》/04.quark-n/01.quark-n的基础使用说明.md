---
title: quark-n的基础使用说明
date: 2021-07-01 22:49:58
permalink: /pages/144bc7/
categories:
  - 《微机》
  - quark-n
tags:
  - 
---
<p align="center"><img style="margin: 10px" width="300" src="https://image.haxbk.com/blog/quark-n.jpg"></div><img style="margin: 10px"  width="300" src="https://image.haxbk.com/blog/quark-n2.jpg"></p>

wiki: https://wiki.seeedstudio.com/cn/Quantum-Mini-Linux-Development-Kit/  
大神项目地址：https://github.com/peng-zhihui/Project-Quantum  
<!-- more -->
quark-n原系统使用：https://gitee.com/coolflyreg163/quark-n  
安装openwrt：https://github.com/kingo132/quark-n-openwrt  
启动网络：http://wiki.friendlyarm.com/wiki/index.php/Use_NetworkManager_to_configure_network_settings  

### 系统安装
烧录软件下载 https://www.balena.io/etcher/  
系统下载 https://files.seeedstudio.com/wiki/Quantum-Mini-Linux-Dev-Kit/quark-n-21-1-11.zip  
balenaEtcher烧录完镜像至tf卡后上电开机即可  

系统默认用户和密码  
users: pi  
password: quark  

users: root  
password: quark  

进系统后
可用npi-config命令来配置系统，如用户、系统语言、时区、ssh等  
npi-config->Advanced Options 中不懂不要轻易动  
其他的随便玩

### 串口通讯
CP210X驱动官方地址（墙外）按系统下:：  
https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers  

之后用PuTTY或者mobaxterm进行串口连接 COM口在设备管理里找 波特率115200   

### 网络
#### WIFI篇
打开wifi  
`nmcli r wifi on`

扫码附近wifi  
`nmcli dev wifi`

连接特定wifi （SSID和PASSWORD按自己的修改）  
`nmcli dev wifi connect "SSID" password "PASSWORD" ifname wlan0`

连接网络的时候，如果需要输入提示密码  
`sudo nmcli --ask c up SSID`

如果总是出现提示密码未提供时，并且wifi的加密是wpa/wpa2个人级时，按照下方配置参数
主要参数：
- 802-11-wireless-security.key-mgmt:      wpa-psk
- 802-11-wireless-security.proto:         wpa
- 802-11-wireless-security.pairwise:      ccmp,tkip
- 802-11-wireless-security.group:         ccmp,tkip
- 802-11-wireless-security.psk-flags:     1 (agent-owned)

密码写入文件，wpa-psk类型内容格式：802-11-wireless-security.psk:secret12345

查看已有网络会话  
`nmcli connection show`

切换到wifi2会话  
`nmcli con up wifi2`

查看设状态  
`nmcli device status`

删除网络会话wifi2  
`nmcli con delete wifi2`

查看网络会话详情（| head -n 3）限制显示行数3  
`nmcli con show TL-WR886`

#### 其他设备篇
重启网卡设备  
`sudo ifconfig wlan0 down && sudo ifconfig wlan0 up`

### 远程桌面
系统镜像中包含[xrdp](https://github.com/neutrinolabs/xrdp) 服务  
`ifconfig` 获取ip  
win10里的远程桌面软件直接可以打开连接

### 蓝牙
打开蓝牙  
`bluetoothctl`  
进入 bluetoothctl 界面后。运行scan扫描列出附近所有的蓝牙设备   
`scan on`  
复制设备的MAC地址，然后使用以下命令连接到设备：
```
pair A4:xx:xx:xx:xx:30
trust A4:xx:xx:xx:xx:30
connect A4:xx:xx:xx:xx:30
```
回终端  
`quit`

### 麦克风与喇叭
音频录制  
`sudo arecord -Dhw:2,0 -d 10 -f cd -r 44100 -c 2 -t wav test.wav`

播放wav文件  
`sudo aplay -Dhw:2,0 /home/pi/Music/test.wav`

音量调节  
`sudo alsamixer`

arecord参数解析：  
-D 指定了录音设备，0,1 是card 0 device 1的意思，也就是TDM_Capture  
-d 指定录音的时长，单位时秒  
-f 指定录音格式，通过上面的信息知道只支持 cd cdr dat  
-r 指定了采样率，单位时Hz  
-c 指定channel 个数  
-t 指定生成的文件格式  

### GPIO
测试  
``

### emmc写入与清空
#### TF卡中的系统移到emmc，count的值需要 sudo fdisk -l 先确定mmcblk1 emmc的扇区数量
`sudo dd if=/dev/mmcblk0 of=/dev/mmcblk1 bs=512 count=30777344 & sudo watch -n 5 pkill -USR1 ^dd$`

#### 清空emmc
`sudo dd if=/dev/zero of=/dev/mmcblk1 bs=512 count=30777344 & sudo watch -n 5 pkill -USR1 ^dd$`

### 调整分区大小
emmc默认系统使用9G多空间实际还有5G多未分配空间
使用Gparted进行分区思路 tf卡启动时可调整 emmc上分区（反之亦可，已挂载正在使用的分区Gparted无法调整）

### Linux下声卡独占的原因和解决
简单解决办法如下：
在/boot/defaults/loader.conf或/etc/sysctl.conf中加入下面两行。
```conf
hw.snd.pcm0.vchans=4
hw.snd.maxautovchans=4
```

### TF卡有系统时启动到emmc分区
1. 将 npi-config 覆盖拷贝到 /usr/bin/npi-config
2. 运行sudo npi-config
3. 3 Boot Options -> B3 Boot device -> D3 emmc

### 更新
软件列表更新  
`sudo apt-get update`  
软件更新  
`sudo apt-get upgrade`


### quark-n-clock

ui-clock服务 快速基础调用quark-n上各硬件的ui服务: [https://github.com/tannerhu/quark-n-clock](https://github.com/tannerhu/quark-n-clock)